                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=8425773.14..8425773.64 rows=200 width=52) (actual time=25470.593..25530.150 rows=23951 loops=1)
   Sort Key: (round(avg((count(*))), 3)) DESC, (count(*)) DESC, t.tagname
   Sort Method: quicksort  Memory: 2040kB
   ->  HashAggregate  (cost=8425762.50..8425765.50 rows=200 width=52) (actual time=25432.949..25502.403 rows=23951 loops=1)
         Group Key: t.tagname
         Batches: 1  Memory Usage: 4641kB
         ->  HashAggregate  (cost=6538826.66..7723646.84 rows=40120895 width=24) (actual time=20092.482..23944.877 rows=8802687 loops=1)
               Group Key: t.tagname, q.id
               Planned Partitions: 256  Batches: 257  Memory Usage: 8977kB  Disk Usage: 507720kB
               ->  Hash Join  (cost=989205.40..1498639.22 rows=40120895 width=16) (actual time=6690.649..16070.617 rows=14157617 loops=1)
                     Hash Cond: (qt.tagid = t_1.id)
                     ->  Hash Join  (cost=725141.10..1200007.27 rows=13160857 width=28) (actual time=4165.369..11311.834 rows=14322931 loops=1)
                           Hash Cond: (qt.tagid = t.id)
                           ->  Hash Join  (cost=723185.65..1163502.33 rows=13160857 width=12) (actual time=4145.699..9032.877 rows=14322931 loops=1)
                                 Hash Cond: (qt.questionid = q.id)
                                 ->  Seq Scan on questionstags qt  (cost=0.00..137418.35 rows=8919435 width=16) (actual time=0.026..693.404 rows=8919638 loops=1)
                                 ->  Hash  (cost=650567.87..650567.87 rows=4426222 width=4) (actual time=4144.027..4144.032 rows=4853807 loops=1)
                                       Buckets: 262144  Batches: 32  Memory Usage: 7399kB
                                       ->  Hash Right Join  (cost=127156.81..650567.87 rows=4426222 width=4) (actual time=705.185..3491.164 rows=4853807 loops=1)
                                             Hash Cond: (a.parentid = q.id)
                                             ->  Seq Scan on answers a  (cost=0.00..465494.22 rows=4426222 width=8) (actual time=0.060..1176.575 rows=4427303 loops=1)
                                             ->  Hash  (cost=77941.82..77941.82 rows=2999759 width=4) (actual time=703.288..703.290 rows=3000000 loops=1)
                                                   Buckets: 262144  Batches: 32  Memory Usage: 5355kB
                                                   ->  Index Only Scan using questions_pkey on questions q  (cost=0.43..77941.82 rows=2999759 width=4) (actual time=0.021..288.696 rows=3000000 loops=1)
                                                         Heap Fetches: 0
                           ->  Hash  (cost=1135.20..1135.20 rows=65620 width=16) (actual time=19.085..19.086 rows=65620 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4229kB
                                 ->  Seq Scan on tags t  (cost=0.00..1135.20 rows=65620 width=16) (actual time=0.068..7.392 rows=65620 loops=1)
                     ->  Hash  (cost=263790.89..263790.89 rows=21873 width=4) (actual time=2525.113..2583.403 rows=23951 loops=1)
                           Buckets: 32768  Batches: 1  Memory Usage: 1099kB
                           ->  Finalize HashAggregate  (cost=262970.64..263790.89 rows=21873 width=4) (actual time=2515.661..2579.899 rows=23951 loops=1)
                                 Group Key: t_1.id
                                 Filter: (count(*) > 10)
                                 Batches: 1  Memory Usage: 6673kB
                                 Rows Removed by Filter: 31351
                                 ->  Gather  (cost=248534.24..262314.44 rows=131240 width=12) (actual time=2468.010..2543.157 rows=134331 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Partial HashAggregate  (cost=247534.24..248190.44 rows=65620 width=12) (actual time=2450.978..2458.178 rows=44777 loops=3)
                                             Group Key: t_1.id
                                             Batches: 1  Memory Usage: 5905kB
                                             Worker 0:  Batches: 1  Memory Usage: 5905kB
                                             Worker 1:  Batches: 1  Memory Usage: 5905kB
                                             ->  Parallel Hash Join  (cost=82874.86..228952.09 rows=3716431 width=4) (actual time=1546.625..2091.240 rows=2973213 loops=3)
                                                   Hash Cond: (qt_1.questionid = q_1.id)
                                                   ->  Parallel Hash Join  (cost=1924.89..97069.47 rows=3716431 width=12) (actual time=8.610..659.833 rows=2973213 loops=3)
                                                         Hash Cond: (qt_1.tagid = t_1.id)
                                                         ->  Parallel Seq Scan on questionstags qt_1  (cost=0.00..85388.31 rows=3716431 width=16) (actual time=0.031..208.522 rows=2973213 loops=3)
                                                         ->  Parallel Hash  (cost=1442.39..1442.39 rows=38600 width=4) (actual time=8.359..8.360 rows=21873 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 3648kB
                                                               ->  Parallel Index Only Scan using tags_pkey on tags t_1  (cost=0.29..1442.39 rows=38600 width=4) (actual time=0.061..2.364 rows=21873 loops=3)
                                                                     Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=60443.22..60443.22 rows=1249900 width=4) (actual time=427.318..427.318 rows=1000000 loops=3)
                                                         Buckets: 262144  Batches: 32  Memory Usage: 5792kB
                                                         ->  Parallel Index Only Scan using questions_pkey on questions q_1  (cost=0.43..60443.22 rows=1249900 width=4) (actual time=0.030..106.473 rows=1000000 loops=3)
                                                               Heap Fetches: 0
 Planning Time: 9.396 ms
 JIT:
   Functions: 104
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 3.877 ms, Inlining 190.607 ms, Optimization 225.961 ms, Emission 154.315 ms, Total 574.760 ms
 Execution Time: 25630.675 ms
(62 rows)

