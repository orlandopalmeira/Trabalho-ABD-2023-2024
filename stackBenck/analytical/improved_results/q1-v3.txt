                                                                                               QUERY PLAN                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=86940.26..86951.93 rows=100 width=22) (actual time=654.907..661.272 rows=100 loops=1)
   Buffers: shared hit=52225 read=37041
   ->  Gather Merge  (cost=86940.26..232073.69 rows=1243914 width=22) (actual time=654.906..661.264 rows=100 loops=1)
         Workers Planned: 2
         Workers Launched: 2
         Buffers: shared hit=52225 read=37041
         ->  Sort  (cost=85940.24..87495.13 rows=621957 width=22) (actual time=649.419..649.431 rows=78 loops=3)
               Sort Key: (((COALESCE(q.qcount, '0'::bigint) + COALESCE(a.acount, '0'::bigint)) + COALESCE(c.ccount, '0'::bigint))) DESC
               Sort Method: top-N heapsort  Memory: 31kB
               Buffers: shared hit=52225 read=37041
               Worker 0:  Sort Method: top-N heapsort  Memory: 31kB
               Worker 1:  Sort Method: top-N heapsort  Memory: 32kB
               ->  Hash Left Join  (cost=22782.23..62169.49 rows=621957 width=22) (actual time=260.097..579.678 rows=497565 loops=3)
                     Hash Cond: (u.id = c.userid)
                     Buffers: shared hit=52211 read=37041
                     ->  Hash Left Join  (cost=12743.81..47388.66 rows=621957 width=30) (actual time=146.944..380.675 rows=497565 loops=3)
                           Hash Cond: (u.id = a.owneruserid)
                           Buffers: shared hit=38157 read=32940
                           ->  Hash Left Join  (cost=6696.77..39708.97 rows=621957 width=22) (actual time=76.426..231.697 rows=497565 loops=3)
                                 Hash Cond: (u.id = q.owneruserid)
                                 Buffers: shared hit=21697 read=28584
                                 ->  Parallel Seq Scan on users u  (cost=0.00..31379.57 rows=621957 width=14) (actual time=0.024..53.664 rows=497565 loops=3)
                                       Buffers: shared hit=2074 read=23086
                                 ->  Hash  (cost=6291.16..6291.16 rows=32449 width=16) (actual time=76.203..76.206 rows=34401 loops=3)
                                       Buckets: 65536 (originally 32768)  Batches: 1 (originally 1)  Memory Usage: 2125kB
                                       Buffers: shared hit=19588 read=5497
                                       ->  Subquery Scan on q  (cost=5642.18..6291.16 rows=32449 width=16) (actual time=62.766..70.364 rows=34402 loops=3)
                                             Buffers: shared hit=19588 read=5497
                                             ->  HashAggregate  (cost=5642.18..5966.67 rows=32449 width=16) (actual time=62.765..67.607 rows=34402 loops=3)
                                                   Group Key: questions.owneruserid
                                                   Batches: 1  Memory Usage: 3857kB
                                                   Buffers: shared hit=19588 read=5497
                                                   Worker 0:  Batches: 1  Memory Usage: 3857kB
                                                   Worker 1:  Batches: 1  Memory Usage: 3857kB
                                                   ->  Index Scan using idx_questions_creationdate on questions  (cost=0.44..5474.50 rows=33536 width=8) (actual time=0.056..49.872 rows=37753 loops=3)
                                                         Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
                                                         Buffers: shared hit=19588 read=5497
                           ->  Hash  (cost=5653.76..5653.76 rows=31463 width=16) (actual time=70.348..70.349 rows=23793 loops=3)
                                 Buckets: 32768  Batches: 1  Memory Usage: 1372kB
                                 Buffers: shared hit=16460 read=4356
                                 ->  Subquery Scan on a  (cost=5024.50..5653.76 rows=31463 width=16) (actual time=61.296..66.491 rows=23794 loops=3)
                                       Buffers: shared hit=16460 read=4356
                                       ->  HashAggregate  (cost=5024.50..5339.13 rows=31463 width=16) (actual time=61.295..64.472 rows=23794 loops=3)
                                             Group Key: answers.owneruserid
                                             Batches: 1  Memory Usage: 3089kB
                                             Buffers: shared hit=16460 read=4356
                                             Worker 0:  Batches: 1  Memory Usage: 3089kB
                                             Worker 1:  Batches: 1  Memory Usage: 3089kB
                                             ->  Index Scan using idx_answers_creationdate on answers  (cost=0.44..4833.20 rows=38260 width=8) (actual time=0.073..48.818 rows=37443 loops=3)
                                                   Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
                                                   Buffers: shared hit=16460 read=4356
                     ->  Hash  (cost=9260.45..9260.45 rows=62237 width=16) (actual time=112.830..112.832 rows=36562 loops=3)
                           Buckets: 65536  Batches: 1  Memory Usage: 2226kB
                           Buffers: shared hit=14054 read=4101
                           ->  Subquery Scan on c  (cost=8015.71..9260.45 rows=62237 width=16) (actual time=98.128..106.442 rows=36563 loops=3)
                                 Buffers: shared hit=14054 read=4101
                                 ->  HashAggregate  (cost=8015.71..8638.08 rows=62237 width=16) (actual time=98.127..103.558 rows=36563 loops=3)
                                       Group Key: comments.userid
                                       Batches: 1  Memory Usage: 5393kB
                                       Buffers: shared hit=14054 read=4101
                                       Worker 0:  Batches: 1  Memory Usage: 5393kB
                                       Worker 1:  Batches: 1  Memory Usage: 5393kB
                                       ->  Index Scan using idx_comments_creationdate on comments  (cost=0.44..7409.95 rows=121152 width=8) (actual time=0.051..71.189 rows=115086 loops=3)
                                             Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
                                             Buffers: shared hit=14054 read=4101
 Planning:
   Buffers: shared hit=302 read=51
 Planning Time: 1.432 ms
 Execution Time: 665.909 ms
(69 rows)

