                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=8427000.68..8427001.18 rows=200 width=52) (actual time=24042.955..24110.248 rows=23951 loops=1)
   Sort Key: (round(avg((count(*))), 3)) DESC, (count(*)) DESC, t.tagname
   Sort Method: quicksort  Memory: 2040kB
   ->  HashAggregate  (cost=8426990.04..8426993.04 rows=200 width=52) (actual time=24005.970..24083.080 rows=23951 loops=1)
         Group Key: t.tagname
         Batches: 1  Memory Usage: 4641kB
         ->  HashAggregate  (cost=6539744.92..7724759.30 rows=40127471 width=24) (actual time=18919.164..22625.134 rows=8802687 loops=1)
               Group Key: t.tagname, q.id
               Planned Partitions: 256  Batches: 257  Memory Usage: 8977kB  Disk Usage: 507720kB
               ->  Hash Join  (cost=989259.65..1498731.37 rows=40127471 width=16) (actual time=6318.412..15227.290 rows=14157617 loops=1)
                     Hash Cond: (qt.tagid = t_1.id)
                     ->  Hash Join  (cost=725191.89..1200090.29 rows=13163014 width=28) (actual time=3875.433..10797.810 rows=14322931 loops=1)
                           Hash Cond: (qt.tagid = t.id)
                           ->  Hash Join  (cost=723236.44..1163579.69 rows=13163014 width=12) (actual time=3856.742..8507.365 rows=14322931 loops=1)
                                 Hash Cond: (qt.questionid = q.id)
                                 ->  Seq Scan on questionstags qt  (cost=0.00..137418.35 rows=8919435 width=16) (actual time=0.024..695.852 rows=8919638 loops=1)
                                 ->  Hash  (cost=650600.15..650600.15 rows=4427303 width=4) (actual time=3855.102..3855.107 rows=4853807 loops=1)
                                       Buckets: 262144  Batches: 32  Memory Usage: 7399kB
                                       ->  Hash Right Join  (cost=127164.44..650600.15 rows=4427303 width=4) (actual time=633.483..3277.470 rows=4853807 loops=1)
                                             Hash Cond: (a.parentid = q.id)
                                             ->  Seq Scan on answers a  (cost=0.00..465505.03 rows=4427303 width=8) (actual time=0.056..1108.712 rows=4427303 loops=1)
                                             ->  Hash  (cost=77945.44..77945.44 rows=3000000 width=4) (actual time=631.594..631.596 rows=3000000 loops=1)
                                                   Buckets: 262144  Batches: 32  Memory Usage: 5355kB
                                                   ->  Index Only Scan using questions_pkey on questions q  (cost=0.43..77945.44 rows=3000000 width=4) (actual time=0.022..267.087 rows=3000000 loops=1)
                                                         Heap Fetches: 0
                           ->  Hash  (cost=1135.20..1135.20 rows=65620 width=16) (actual time=18.120..18.120 rows=65620 loops=1)
                                 Buckets: 131072  Batches: 1  Memory Usage: 4229kB
                                 ->  Seq Scan on tags t  (cost=0.00..1135.20 rows=65620 width=16) (actual time=0.050..7.479 rows=65620 loops=1)
                     ->  Hash  (cost=263794.35..263794.35 rows=21873 width=4) (actual time=2442.785..2508.877 rows=23951 loops=1)
                           Buckets: 32768  Batches: 1  Memory Usage: 1099kB
                           ->  Finalize HashAggregate  (cost=262974.10..263794.35 rows=21873 width=4) (actual time=2434.008..2505.687 rows=23951 loops=1)
                                 Group Key: t_1.id
                                 Filter: (count(*) > 10)
                                 Batches: 1  Memory Usage: 6673kB
                                 Rows Removed by Filter: 31351
                                 ->  Gather  (cost=248537.70..262317.90 rows=131240 width=12) (actual time=2389.688..2471.670 rows=134364 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       ->  Partial HashAggregate  (cost=247537.70..248193.90 rows=65620 width=12) (actual time=2373.587..2380.255 rows=44788 loops=3)
                                             Group Key: t_1.id
                                             Batches: 1  Memory Usage: 5905kB
                                             Worker 0:  Batches: 1  Memory Usage: 5905kB
                                             Worker 1:  Batches: 1  Memory Usage: 5905kB
                                             ->  Parallel Hash Join  (cost=82878.32..228955.54 rows=3716431 width=4) (actual time=1508.023..2032.374 rows=2973213 loops=3)
                                                   Hash Cond: (qt_1.questionid = q_1.id)
                                                   ->  Parallel Hash Join  (cost=1924.89..97069.47 rows=3716431 width=12) (actual time=8.222..663.998 rows=2973213 loops=3)
                                                         Hash Cond: (qt_1.tagid = t_1.id)
                                                         ->  Parallel Seq Scan on questionstags qt_1  (cost=0.00..85388.31 rows=3716431 width=16) (actual time=0.019..207.596 rows=2973213 loops=3)
                                                         ->  Parallel Hash  (cost=1442.39..1442.39 rows=38600 width=4) (actual time=7.949..7.950 rows=21873 loops=3)
                                                               Buckets: 131072  Batches: 1  Memory Usage: 3616kB
                                                               ->  Parallel Index Only Scan using tags_pkey on tags t_1  (cost=0.29..1442.39 rows=38600 width=4) (actual time=0.071..2.332 rows=21873 loops=3)
                                                                     Heap Fetches: 0
                                                   ->  Parallel Hash  (cost=60445.43..60445.43 rows=1250000 width=4) (actual time=420.236..420.237 rows=1000000 loops=3)
                                                         Buckets: 262144  Batches: 32  Memory Usage: 5792kB
                                                         ->  Parallel Index Only Scan using questions_pkey on questions q_1  (cost=0.43..60445.43 rows=1250000 width=4) (actual time=0.033..108.945 rows=1000000 loops=3)
                                                               Heap Fetches: 0
 Planning Time: 1.956 ms
 JIT:
   Functions: 104
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 4.123 ms, Inlining 187.245 ms, Optimization 229.214 ms, Emission 155.169 ms, Total 575.752 ms
 Execution Time: 24212.748 ms
(62 rows)

