                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=276175.16..276175.41 rows=100 width=22) (actual time=3642.082..3642.095 rows=100 loops=1)
   ->  Sort  (cost=276175.16..279906.90 rows=1492696 width=22) (actual time=3623.846..3623.853 rows=100 loops=1)
         Sort Key: (((count(DISTINCT questions.id) + count(DISTINCT answers.id)) + count(DISTINCT comments.id))) DESC
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=36290.23..219125.40 rows=1492696 width=22) (actual time=170.174..3420.835 rows=1492696 loops=1)
               Group Key: u.id
               ->  Incremental Sort  (cost=36290.23..181808.00 rows=1492696 width=26) (actual time=169.785..1574.678 rows=2140737 loops=1)
                     Sort Key: u.id, questions.id
                     Presorted Key: u.id
                     Full-sort Groups: 48489  Sort Method: quicksort  Average Memory: 28kB  Peak Memory: 28kB
                     Pre-sorted Groups: 15556  Sort Method: quicksort  Average Memory: 1715kB  Peak Memory: 2089kB
                     ->  Merge Left Join  (cost=36290.17..114636.68 rows=1492696 width=26) (actual time=169.147..1176.698 rows=2140737 loops=1)
                           Merge Cond: (u.id = comments.userid)
                           ->  Merge Left Join  (cost=16121.66..88609.56 rows=1492696 width=22) (actual time=89.676..805.511 rows=1508320 loops=1)
                                 Merge Cond: (u.id = answers.owneruserid)
                                 ->  Merge Left Join  (cost=8208.93..76386.43 rows=1492696 width=18) (actual time=49.429..586.326 rows=1496081 loops=1)
                                       Merge Cond: (u.id = questions.owneruserid)
                                       ->  Index Scan using users_pkey on users u  (cost=0.43..63941.01 rows=1492696 width=14) (actual time=0.024..318.431 rows=1492696 loops=1)
                                       ->  Sort  (cost=8208.49..8294.48 rows=34396 width=12) (actual time=49.371..56.500 rows=38502 loops=1)
                                             Sort Key: questions.owneruserid
                                             Sort Method: quicksort  Memory: 3043kB
                                             ->  Index Scan using idx_questions_creationdate on questions  (cost=0.44..5616.76 rows=34396 width=12) (actual time=0.090..40.008 rows=38587 loops=1)
                                                   Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
                                 ->  Sort  (cost=7912.70..8010.32 rows=39045 width=12) (actual time=40.162..47.737 rows=40256 loops=1)
                                       Sort Key: answers.owneruserid
                                       Sort Method: quicksort  Memory: 3035kB
                                       ->  Index Scan using idx_answers_creationdate on answers  (cost=0.44..4934.97 rows=39045 width=12) (actual time=0.053..31.486 rows=38382 loops=1)
                                             Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
                           ->  Materialize  (cost=20167.48..20786.75 rows=123853 width=12) (actual time=79.437..125.597 rows=690133 loops=1)
                                 ->  Sort  (cost=20167.48..20477.12 rows=123853 width=12) (actual time=79.432..91.108 rows=117606 loops=1)
                                       Sort Key: comments.userid
                                       Sort Method: external merge  Disk: 3000kB
                                       ->  Index Scan using idx_comments_creationdate on comments  (cost=0.44..7573.09 rows=123853 width=12) (actual time=0.069..48.131 rows=117765 loops=1)
                                             Index Cond: ((creationdate >= (now() - '6 mons'::interval)) AND (creationdate <= now()))
 Planning Time: 1.558 ms
 JIT:
   Functions: 41
   Options: Inlining false, Optimization false, Expressions true, Deforming true
   Timing: Generation 1.822 ms, Inlining 0.000 ms, Optimization 0.718 ms, Emission 17.603 ms, Total 20.143 ms
 Execution Time: 3663.838 ms
(40 rows)

