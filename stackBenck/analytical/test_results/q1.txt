                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1601108.95..1601109.20 rows=100 width=22) (actual time=27072.613..27072.778 rows=100 loops=1)
   ->  Sort  (cost=1601108.95..1604840.69 rows=1492696 width=22) (actual time=26691.701..26691.860 rows=100 loops=1)
         Sort Key: (((count(DISTINCT questions.id) + count(DISTINCT answers.id)) + count(DISTINCT comments.id))) DESC
         Sort Method: top-N heapsort  Memory: 32kB
         ->  GroupAggregate  (cost=1361253.89..1544059.19 rows=1492696 width=22) (actual time=23048.890..26489.496 rows=1492696 loops=1)
               Group Key: u.id
               ->  Incremental Sort  (cost=1361253.89..1506741.79 rows=1492696 width=26) (actual time=23048.484..24612.313 rows=2141516 loops=1)
                     Sort Key: u.id, questions.id
                     Presorted Key: u.id
                     Full-sort Groups: 48491  Sort Method: quicksort  Average Memory: 28kB  Peak Memory: 28kB
                     Pre-sorted Groups: 15537  Sort Method: quicksort  Average Memory: 1715kB  Peak Memory: 2089kB
                     ->  Merge Left Join  (cost=1361253.83..1439570.47 rows=1492696 width=26) (actual time=23047.858..24212.904 rows=2141516 loops=1)
                           Merge Cond: (u.id = comments.userid)
                           ->  Merge Left Join  (cost=901853.86..974330.90 rows=1492696 width=22) (actual time=16524.320..17420.221 rows=1508340 loops=1)
                                 Merge Cond: (u.id = answers.owneruserid)
                                 ->  Merge Left Join  (cost=431325.94..499499.22 rows=1492696 width=18) (actual time=8248.601..8981.014 rows=1496089 loops=1)
                                       Merge Cond: (u.id = questions.owneruserid)
                                       ->  Index Scan using users_pkey on users u  (cost=0.43..63941.01 rows=1492696 width=14) (actual time=8.174..554.001 rows=1492696 loops=1)
                                       ->  Sort  (cost=431325.50..431410.77 rows=34108 width=12) (actual time=8240.373..8246.578 rows=38533 loops=1)
                                             Sort Key: questions.owneruserid
                                             Sort Method: quicksort  Memory: 3044kB
                                             ->  Gather  (cost=1000.00..428757.54 rows=34108 width=12) (actual time=8031.451..8230.357 rows=38618 loops=1)
                                                   Workers Planned: 2
                                                   Workers Launched: 2
                                                   ->  Parallel Seq Scan on questions  (cost=0.00..424346.74 rows=14212 width=12) (actual time=7488.613..8212.346 rows=12873 loops=3)
                                                         Filter: ((creationdate <= now()) AND (creationdate >= (now() - '6 mons'::interval)))
                                                         Rows Removed by Filter: 987127
                                 ->  Sort  (cost=470527.89..470624.38 rows=38597 width=12) (actual time=8275.685..8282.248 rows=40283 loops=1)
                                       Sort Key: answers.owneruserid
                                       Sort Method: quicksort  Memory: 3036kB
                                       ->  Gather  (cost=1000.00..467587.53 rows=38597 width=12) (actual time=8050.313..8267.614 rows=38403 loops=1)
                                             Workers Planned: 2
                                             Workers Launched: 2
                                             ->  Parallel Seq Scan on answers  (cost=0.00..462727.83 rows=16082 width=12) (actual time=8038.379..8253.527 rows=12801 loops=3)
                                                   Filter: ((creationdate <= now()) AND (creationdate >= (now() - '6 mons'::interval)))
                                                   Rows Removed by Filter: 1462967
                           ->  Materialize  (cost=459398.95..460012.68 rows=122746 width=12) (actual time=6523.503..6570.244 rows=690932 loops=1)
                                 ->  Sort  (cost=459398.95..459705.82 rows=122746 width=12) (actual time=6523.490..6535.165 rows=117667 loops=1)
                                       Sort Key: comments.userid
                                       Sort Method: external merge  Disk: 3008kB
                                       ->  Gather  (cost=1000.00..446923.65 rows=122746 width=12) (actual time=6210.165..6488.187 rows=117827 loops=1)
                                             Workers Planned: 2
                                             Workers Launched: 2
                                             ->  Parallel Seq Scan on comments  (cost=0.00..433649.05 rows=51144 width=12) (actual time=6214.959..6474.672 rows=39276 loops=3)
                                                   Filter: ((creationdate <= now()) AND (creationdate >= (now() - '6 mons'::interval)))
                                                   Rows Removed by Filter: 3708326
 Planning Time: 49.667 ms
 JIT:
   Functions: 59
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 4.803 ms, Inlining 467.088 ms, Optimization 223.693 ms, Emission 185.629 ms, Total 881.213 ms
 Execution Time: 27642.480 ms
(52 rows)

